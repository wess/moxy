#!/usr/bin/env bash
set -euo pipefail

REPO="wess/moxy"

version=""

if command -v gh >/dev/null 2>&1; then
  version=$(gh api "repos/${REPO}/releases/latest" --jq '.tag_name' 2>/dev/null || true)
fi

if [ -z "${version}" ]; then
  version=$(
    curl -fsSL "https://api.github.com/repos/${REPO}/releases/latest" 2>/dev/null \
      | grep '"tag_name"' | head -1 | sed 's/.*"\(.*\)".*/\1/'
  )
fi

if [ -z "${version}" ]; then
  echo "No releases found" >&2
  exit 1
fi

echo "${version}" | sed 's/^v//'
