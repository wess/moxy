#include <stdlib.h>
#include <stdio.h>
#include <stdbool.h>
#include <string.h>

typedef struct {
    struct { const char* key; int val; } *entries;
    int len;
    int cap;
} map_string_int;

static map_string_int map_string_int_make(void) {
    map_string_int m;
    m.cap = 8;
    m.entries = malloc(m.cap * sizeof(*m.entries));
    m.len = 0;
    return m;
}

static void map_string_int_set(map_string_int *m, const char* key, int val) {
    for (int i = 0; i < m->len; i++) {
        if (strcmp(m->entries[i].key, key) == 0) { m->entries[i].val = val; return; }
    }
    if (m->len >= m->cap) {
        m->cap *= 2;
        m->entries = realloc(m->entries, m->cap * sizeof(*m->entries));
    }
    m->entries[m->len].key = key;
    m->entries[m->len].val = val;
    m->len++;
}

static int map_string_int_get(map_string_int *m, const char* key) {
    for (int i = 0; i < m->len; i++)
        if (strcmp(m->entries[i].key, key) == 0) return m->entries[i].val;
    return (int){0};
}

static bool map_string_int_has(map_string_int *m, const char* key) {
    for (int i = 0; i < m->len; i++)
        if (strcmp(m->entries[i].key, key) == 0) return true;
    return false;
}



int main(void) {
    map_string_int ages = map_string_int_make();
    map_string_int_set(&ages, "alice", 30);
    map_string_int_set(&ages, "bob", 25);
    printf("%d\n", map_string_int_get(&ages, "alice"));
    printf("%d\n", map_string_int_has(&ages, "bob"));
    printf("%d\n", ages.len);
    return 0;
}

